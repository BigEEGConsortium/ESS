function [uniqueTag, uniqueTagEntropy, uniqueTagEventCodes, uniqueTagEventCodeCounts] = get_unique_tags(tag, tagEventCode, tagEventCount)

%% combine records to form unique (tag,code) tuples
randomString = getUuid;
combined = strcat(tagEventCode, randomString, tag);
[dummy uniqueStringId originIds] = unique(combined, 'stable');
eventCode = originalEventCode(uniqueStringId);
eventHEDString = originalEventHEDString(uniqueStringId);

%%


[uniqueTag uniqueTagId originTagIds] = unique(tag, 'stable');
tagText = {};
for i=1:length(uniqueTag)
    tagText{i} = ['tag: ' uniqueTag{i} ', '];
    codeId = find(originTagIds == i);
    uniqueTagEventCodes{i} =  tagEventCode(codeId);
    uniqueTagEventCodeCounts{i} =  tagEventCount(codeId);
    p =  uniqueTagEventCodeCounts{i} / sum(uniqueTagEventCodeCounts{i});
    uniqueTagEntropy(i) = sum(p.*log(p));
    for j=1:length(codeId)
        tagText{i} = [tagText{i} 'event ' tagEventCode{codeId(j)} '(' num2str(tagEventCount(codeId(j))) '),'];
    end
end;
